<html>
<head>
<script src="DOMToRender.js"></script>
<script src="render.js"></script>
<script src="runSelectors.js"></script>
<script src="sizzle.js"></script>
<script src="fisheye.js"></script>
<script>
function sqrt(a) { return Math.sqrt(a); }
</script>
<script>
	attrMap = {};
	otherAttrs = ['mousex', 'mouseY'];	 
	logger = {log: function(){}, err: function (e) { console.error(e); }};
	
	function loader() {
	
	  otherAttrs = []; //array of input attributes that can be set by CSS selectors
	  otherAttrs.push('refName');
	  
	  var doc = document.getElementById('content'); 
	  var cnv = document.getElementById('cnv');
		
	  runSelectors([document.getElementById('documentStyle')], Sizzle("#content, #content *"));
	  var data = coreDraw(doc, cnv, true, true, false);
//	  console.log(data);
	  
	  
	  var dirty = false;	  
	  window.addEventListener('mousemove',
	    function(evt) {	    
		  data.addedStyles.mousex = evt.offsetX;
		  data.addedStyles.mousey = evt.offsetY;
		  dirty = true;		  
	    });	  
	    
	  setInterval(function() {
			if (dirty) {
				coreDraw2(data, cnv);
				dirty = false;
//				console.log('redraw');
			}
		}, 20);

	}
	window.addEventListener('load', loader);	
</script>
</head>
<body>
<style id="documentStyle">
top > * { refName: child; }
* { refName: childs; }
top { mouseX: 10; mouseY : 10; }
</style>
<top id="content">
<vbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>
  <hbox>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
    <leaf></leaf>
  </hbox>

</vbox>
</top>
<h1>Canvas</h1>
<canvas style="margin-left: auto; margin-right: auto" id="cnv"></canvas>
<h1>Widgets</h1>
<iframe src="fisheye.ftl" style="width: 100%; max-width: 50em; height: 20em"></iframe>

</body>
</html>